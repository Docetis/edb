# edb â€” eXist-DB CLI Toolkit
Export â€¢ Import â€¢ Watch-Sync â€¢ Auto-Backup â€¢ XAR Build â€¢ Rollback

A modern development toolchain for **eXist-db applications**, built as a single portable Bash CLI.

Designed for developers who need rapid iteration, safe deployment, predictable rollbacks and Git-friendly workflows.

---

## ğŸš€ Features

| Command | Purpose |
|---|---|
| `edb export` | Download a collection from eXist â†’ local directory |
| `edb import` | Upload local files â†’ DB (with **automatic backup**) |
| `edb watch` | Live-sync files on save â€” ideal for development |
| `edb build-xar` | Build `.xar` package for deployment |
| `edb backup` | Manual backup of the remote application |
| `edb rollback last` | Restore latest backup instantly |
| `edb rollback <timestamp>` | Restore from a specific backup snapshot |

---

## ğŸ“¥ Installation

### Homebrew (recommended)

Requires the `homebrew-edb` tap repo.

```
brew tap Docetis/edb
brew install edb
```

---

### Manual usage

```
chmod +x edb.sh
./edb.sh init
./edb.sh edit   # configure eXist URL, username, paths
```

---

## ğŸ”§ Configuration (.env)

Generated automatically by `edb init`

```
EDB_SERVER_URL="http://localhost:8080/exist"
EDB_USER="admin"
EDB_PASS="password"
EDB_COLLECTION="/db/apps/myapp"
EDB_LOCAL_DIR="./myapp"

# Optional build settings
EDB_XAR_NAME="myapp"
EDB_XAR_VERSION="0.0.1"
EDB_XAR_DIST_DIR="./dist"

# Optional backup settings
EDB_BACKUP_DIR="./backups"
EDB_BACKUP_KEEP=10
```

---

## ğŸ”„ Development workflow (recommended)

```
edb export        # Pull remote app â†’ local workspace
edb watch         # Automatic sync while coding
edb build-xar     # Build deployable package
edb import        # Deploy â€” auto-backup included
```

Ideal for rapid development cycles.

---

## ğŸ›Ÿ Automatic Backups

Every `edb import` triggers a backup first:

```
backups/<app>/<timestamp>/
```

Backups rotate automatically based on `EDB_BACKUP_KEEP`.

---

## âª Rollback System

Mistake on deployment? One command fixes everything:

```
edb rollback last        # revert to most recent backup
edb rollback 20250312_102355   # restore specific snapshot
```

Rollback does **not** create another backup to avoid loops.

---

## ğŸ“¦ XAR Build

```
edb build-xar
```

Output examples:

```
dist/myapp-20250312_113544.xar
dist/myapp-latest.xar â†’ auto-updated alias
```

---

## ğŸ”­ Roadmap

| Planned | Status |
|---|---|
| Diff-only upload | ğŸš§ next milestone |
| One-command deployment from XAR | ğŸ”œ |
| Remote log tailing | ğŸ”œ |
| Web-GUI frontend | idea ğŸ’¡ |

---

## ğŸ§¾ License

MIT â€” free for commercial & open-source use.

---

## ğŸ‘¤ Author & Credits

Built collaboratively with human direction and generated by  
**ChatGPT (OpenAI) â€” scallion4o personality**  
Maintained by the Docetis Team.
